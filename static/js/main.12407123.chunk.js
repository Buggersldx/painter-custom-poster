(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t,a){e.exports=a(183)},115:function(e,t,a){},121:function(e,t){},122:function(e,t){},123:function(e,t){},124:function(e,t,a){},183:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(4),i=a.n(o);a(115),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=a(74),c=a.n(s),d=a(24),l=a(94),u=a(95),h=a(96),g=a(108),p=a(97),m=a(25),v=a(107),f=a(98),b=a.n(f),S=a(58),w=a.n(S),y=a(99),x=a.n(y),k=a(48),C={color:"#000000",background:"#538e60",bottom:40,top:100,right:40,left:100,width:100,height:200,rotate:0,borderRadius:10,borderWidth:2,borderColor:"#000000",align:["center","left","right"],shadow:"10 10 5 #888888"},E=[{type:"canvas",css:{width:"654",height:"1000",background:"#eee"}},{type:"text",name:"\u6587\u5b57",css:Object(k.a)({},C,{text:"    \u6211\u662f\u6765\u6d4b\u8bd5\u7684\u963f\u53d1\u53d1\u8428\u82ac\u6492\u53d1",fontSize:"30",fontWeight:"bold",maxLines:"",lineHeight:"20",textStyle:["fill","stroke"],fontFamily:"",textAlign:["center","left","right"],padding:"10",textDecoration:["none","overline","underline","linethrough"],hasBorder:[1,1]})},{type:"rect",name:"\u77e9\u5f62",css:Object(k.a)({},C)},{type:"image",name:"\u56fe\u7247",css:Object(k.a)({},C,{mode:["aspectFill","scaleToFill","aspectFill"]})},{type:"qrcode",name:"\u4e8c\u7ef4\u7801",css:Object(k.a)({},C)}],O=(a(124),a(185)),B=a(187),j=a(59),I=a(186),R=a(100),N=a.n(R),F=O.a.Option;fabric=b.a.fabric,B.a.config({maxCount:1});var A=2,_={canvasState:[],currentStateIndex:-1,undoStatus:!1,redoStatus:!1,undoFinishedStatus:1,redoFinishedStatus:1},W=w.a.cloneDeep(E);W[1].css.textStyle=W[1].css.textStyle[0],W[1].css.textAlign=W[1].css.textAlign[0],W[1].css.textDecoration=W[1].css.textDecoration[0],W[1].css.hasBorder=W[1].css.hasBorder[0],W[3].css.mode=W[3].css.mode[0];var U=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(g.a)(this,Object(p.a)(t).call(this,e))).addShape=a.addShape.bind(Object(m.a)(a)),a.generateCode=a.generateCode.bind(Object(m.a)(a)),a.copyCode=a.copyCode.bind(Object(m.a)(a)),a.viewCode=a.viewCode.bind(Object(m.a)(a)),a.handerUndo=a.handerUndo.bind(Object(m.a)(a)),a.handerRedo=a.handerRedo.bind(Object(m.a)(a)),a.state={redoButtonStatus:"",undoButtonStatus:""},a.currentOptionArr=W,a.views=[],a.canvas_sprite="",a.shapes={text:[],rect:[],image:[],qrcode:[]},a.height=300,a.width=0,a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.canvas_sprite=new fabric.Canvas("merge");var e=this;this.canvas_sprite.on("object:moving",function(e){var t=e.target;t.currentHeight>t.canvas.height||t.currentWidth>t.canvas.width||(t.setCoords(),(t.getBoundingRect().top<0||t.getBoundingRect().left<0)&&(t.top=Math.max(t.top,t.top-t.getBoundingRect().top),t.left=Math.max(t.left,t.left-t.getBoundingRect().left)),(t.getBoundingRect().top+t.getBoundingRect().height>t.canvas.height||t.getBoundingRect().left+t.getBoundingRect().width>t.canvas.width)&&(t.top=Math.min(t.top,t.canvas.height-t.getBoundingRect().height+t.top-t.getBoundingRect().top),t.left=Math.min(t.left,t.canvas.width-t.getBoundingRect().width+t.left-t.getBoundingRect().left)))}),this.canvas_sprite.on("object:modified",function(){e.updateCanvasState()}),this.canvas_sprite.on("object:added",function(){e.updateCanvasState()}),this.addShape(1)}},{key:"addShape",value:function(){var e=Object(l.a)(c.a.mark(function e(t){var a,n,r,o,i,s,l,u,h,g,p,m,v,f,b,S,w,y,k,C,E,O,B,j,I,R,N,F,_,W,U;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this,r=this.currentOptionArr,o=r[t],i=o.type,s=o.css,l=s.width,u=s.height,h=s.text,g=s.color,p=s.fontSize,m=s.left,v=s.top,f=s.fontWeight,b=s.fontFamily,S=s.padding,w=s.textDecoration,y=s.borderRadius,k=s.borderWidth,C=s.borderColor,E=s.background,O=s.rotate,B=s.hasBorder,j=s.align,I=s.shadow,R=s.mode,e.t0=i,e.next="text"===e.t0?7:"rect"===e.t0?11:"image"===e.t0?13:"qrcode"===e.t0?18:24;break;case 7:return a={width:l,height:u,fill:g,fontWeight:f,left:m,top:v,fontSize:p,fontFamily:b,padding:S},Object(d.a)(a,w,!0),Object(d.a)(a,"textAlign",j),Object(d.a)(a,"shadow",I),Object(d.a)(a,"angle",O),Object(d.a)(a,"splitByGrapheme",!0),Object(d.a)(a,"zIndex",2),F=a,_=new fabric.Textbox(h,F),1===B?(W=new fabric.Rect({width:l,height:u,left:m,top:v,rx:y,strokeWidth:k,stroke:C,fill:"rgba(0,0,0,0)",angle:O,selectable:!1}),this.canvas_sprite.add(W),(N=_).on("moving",function(e){console.log("eeeee",e),W.set({left:e.target.left,top:e.target.top}),n.canvas_sprite.renderAll()}),N.on("scaling",function(e){W.set({width:e.target.width,height:e.target.height}),n.canvas_sprite.renderAll()}),N.on("rotating",function(e){W.set({angle:e.target.angle,originX:"left",originY:"top",width:e.target.width,height:e.target.height,left:e.target.left,top:e.target.top}),n.canvas_sprite.renderAll()})):N=_,e.abrupt("break",25);case 11:return N=new fabric.Rect({width:l,height:u,left:m,top:v,borderRadius:y,borderWidth:k,borderColor:C,backgroundColor:E,align:j,rotate:O,shadow:I}),e.abrupt("break",25);case 13:return e.next=15,this.loadImageUrl("https://operate.maiyariji.com/20190709%2F3da002983292a6950a71ca7392a21827.jpg");case 15:return(N=e.sent).set({width:l,height:u,left:m,top:v,borderRadius:y,borderWidth:k,borderColor:C,backgroundColor:E,align:j,rotate:O,mode:R,shadow:I}),e.abrupt("break",25);case 18:return U=x.a.getQrBase64("hello world",{padding:S,width:l,height:u,correctLevel:A,reverse:!1,background:E,foreground:g}),e.next=21,this.loadImageUrl(U);case 21:return(N=e.sent).set({width:l,height:u,left:m,top:v,borderRadius:y,borderWidth:k,borderColor:C,backgroundColor:E,align:j,rotate:O,mode:R,shadow:I}),e.abrupt("break",25);case 24:return e.abrupt("break",25);case 25:this.shapes[i].push(N),this.canvas_sprite.add(N);case 27:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadImageUrl",value:function(e){return new Promise(function(t){fabric.Image.fromURL(e,function(e){t(e)})})}},{key:"clearCanvas",value:function(){this.rects.forEach(function(e,t){e.remove()}),this.texts.forEach(function(e,t){e.remove()})}},{key:"generateCode",value:function(){var e=this,t=this.shapes;this.views=[],Object.keys(t).forEach(function(a){t[a].forEach(function(t,a){console.log("shapes[item2]",t),e.views.push(t)})})}},{key:"copyCode",value:function(){N()("http://baidu.com")?B.a.success("\u590d\u5236\u6210\u529f,\u8bf7\u8d76\u5feb\u53bbpainter\u7c98\u8d34\u4ee3\u7801\u67e5\u770b\u6548\u679c",2):B.a.error("\u590d\u5236\u5931\u8d25,\u8bf7\u91cd\u8bd5\u6216\u8005\u53bb\u8c37\u6b4c\u6d4f\u89c8\u5668\u5c1d\u8bd5",2)}},{key:"viewCode",value:function(){}},{key:"updateCanvasState",value:function(){var e=this.canvas_sprite;if(!1===_.undoStatus&&!1===_.redoStatus){var t=e.toJSON(),a=JSON.stringify(t);if(_.currentStateIndex<_.canvasState.length-1){var n=_.currentStateIndex+1;_.canvasState[n]=a;var r=n+1;_.canvasState=_.canvasState.splice(0,r)}else _.canvasState.push(a);_.currentStateIndex=_.canvasState.length-1,_.currentStateIndex===_.canvasState.length-1&&-1!==_.currentStateIndex&&this.setState({redoButtonStatus:"disabled"})}}},{key:"handerUndo",value:function(){var e=this,t=this.canvas_sprite;_.undoFinishedStatus&&(-1===_.currentStateIndex?_.undoStatus=!1:_.canvasState.length>=1&&(_.undoFinishedStatus=0,0!==_.currentStateIndex?(_.undoStatus=!0,t.loadFromJSON(_.canvasState[_.currentStateIndex-1],function(){t.renderAll(),_.undoStatus=!1,_.currentStateIndex-=1,e.setState({undoButtonStatus:""}),_.currentStateIndex!==_.canvasState.length-1&&e.setState({redoButtonStatus:""}),_.undoFinishedStatus=1})):0===_.currentStateIndex&&(t.clear(),_.undoFinishedStatus=1,e.setState({redoButtonStatus:"",undoButtonStatus:"disabled"}),_.currentStateIndex-=1)))}},{key:"handerRedo",value:function(){var e=this,t=this.canvas_sprite;_.redoFinishedStatus&&(_.currentStateIndex===_.canvasState.length-1&&-1!==_.currentStateIndex?e.setState({redoButtonStatus:"disabled"}):_.canvasState.length>_.currentStateIndex&&0!==_.canvasState.length&&(_.redoFinishedStatus=0,_.redoStatus=!0,t.loadFromJSON(_.canvasState[_.currentStateIndex+1],function(){t.renderAll(),_.redoStatus=!1,_.currentStateIndex+=1,-1!==_.currentStateIndex&&e.setState({undoButtonStatus:""}),_.redoFinishedStatus=1,_.currentStateIndex===_.canvasState.length-1&&-1!==_.currentStateIndex&&e.setState({redoButtonStatus:"disabled"})})))}},{key:"render",value:function(){var e=this,t=this.currentOptionArr;return r.a.createElement("div",{id:"main"},r.a.createElement("div",{className:"slide"},r.a.createElement("canvas",{id:"merge",width:"700",height:"1000"})),r.a.createElement("div",{className:"main-container"},r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"btns"},r.a.createElement("div",{className:"btn"},r.a.createElement(j.a,{type:"primary",onClick:this.handerUndo},"Undo")),r.a.createElement("div",{className:"btn"},r.a.createElement(j.a,{type:"primary",onClick:this.handerRedo},"Redo")),r.a.createElement("div",{className:"btn"},r.a.createElement(j.a,{type:"primary",onClick:this.generateCode},"\u751f\u6210\u4ee3\u7801")),r.a.createElement("div",{className:"btn"},r.a.createElement(j.a,{type:"primary",onClick:this.copyCode},"\u590d\u5236\u4ee3\u7801")),r.a.createElement("div",{className:"btn"},r.a.createElement(j.a,{type:"primary",onClick:this.viewCode},"\u67e5\u770b\u4ee3\u7801"))),r.a.createElement("div",{className:"code"})),r.a.createElement("div",{className:"option"},E.map(function(a,n){return 0===n?null:r.a.createElement("div",{key:n,className:"option-li"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"h3"},a.name," "),r.a.createElement("div",{className:"btn"},r.a.createElement(j.a,{type:"primary",onClick:e.addShape.bind(e,n)},"\u6dfb\u52a0"))),Object.keys(a.css).map(function(e,o){return r.a.createElement("div",{className:"row",key:o},r.a.createElement("div",{className:"h3"},e," "),!w.a.isArray(a.css[e])&&r.a.createElement(I.a,{defaultValue:a.css[e],onChange:function(a){t[n].css[e]=a.target.value}}),w.a.isArray(a.css[e])&&r.a.createElement(O.a,{defaultValue:a.css[e][0],style:{width:120},onChange:function(a){t[n].css[e]=a}},a.css[e].map(function(e,t){return r.a.createElement(F,{value:e,key:t},e)})))}))}))))}}]),t}(r.a.Component);i.a.render(r.a.createElement("div",null,r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[110,1,2]]]);
//# sourceMappingURL=main.12407123.chunk.js.map